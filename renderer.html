<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Metaverse Key Supporter</title>
  <style>
    body {
      font-family: sans-serif;
      margin: 20px;
    }
    iframe {
      width: 100%;
      height: 500px;
      margin-top: 10px;
      border: 1px solid #ccc;
    }
    input, button {
      margin: 5px;
      padding: 5px;
      font-size: 16px;
    }

    .url-bar {
      display: flex;
      align-items: center;
      gap: 10px;
      flex-wrap: wrap;
      margin-bottom: 15px;
    }

    .url-bar label {
      font-weight: bold;
      white-space: nowrap;
    }

    .url-bar input[type="text"] {
      flex: 1;
      min-width: 250px;
      padding: 5px;
    }

    .controls {
      display: flex;
      align-items: flex-start;
      justify-content: space-between;
      margin-top: 10px;
      flex-wrap: wrap;
    }

    .key-control {
      flex: 1 1 400px;
    }

    .quick-keys {
      flex: 1 1 400px;
      max-width: 500px;
    }

    .quick-keys button,
    .quick-seconds button {
      margin: 4px;
      padding: 8px 12px;
      font-size: 16px;
      border-radius: 4px;
      border: 1px solid #888;
      background-color: #f0f0f0;
      cursor: pointer;
    }

    .quick-keys button:hover,
    .quick-seconds button:hover {
      background-color: #ddd;
    }
  </style>
</head>
<body>
  <!-- âœ… ãƒ¡ã‚¿ãƒãƒ¼ã‚¹URLå…¥åŠ›ï¼ˆæ¨ªä¸¦ã³ï¼‰ -->
  <div class="url-bar">
    <label for="urlInput">ğŸŒ ãƒ¡ã‚¿ãƒãƒ¼ã‚¹URLæŒ‡å®š</label>
    <input id="urlInput" type="text" value="https://cloud.vket.com/" />
    <button onclick="loadURL()">èª­ã¿è¾¼ã¿</button>
    <button onclick="openInBrowser()">ğŸŒ å¤–éƒ¨ãƒ–ãƒ©ã‚¦ã‚¶ã§é–‹ã</button>
  </div>

  <!-- âœ… ãƒ¡ã‚¿ãƒãƒ¼ã‚¹ãƒ“ãƒ¥ãƒ¼ -->
  <!--ã€€<iframe id="webview" sandbox="allow-scripts allow-same-origin allow-forms allow-popups"></iframe>ã€€-->
  <webview id="webview" style="width:100%; height:500px; border:1px solid #ccc;"></webview>

  <!-- âœ… ã‚­ãƒ¼æ“ä½œï¼†ã‚·ãƒ§ãƒ¼ãƒˆã‚«ãƒƒãƒˆ -->
  <div class="controls">
    <!-- å·¦ï¼šã‚­ãƒ¼å…¥åŠ›ãƒ»ç§’æ•°ãƒ»é€ä¿¡ -->
    <div class="key-control">
      <h3>âŒ¨ï¸ ã‚­ãƒ¼æ“ä½œï¼ˆæŠ¼ä¸‹ â†’ æŒ‡å®šç§’å¾Œã«è§£æ”¾ï¼‰</h3>

      <label>ã‚­ãƒ¼åï¼ˆã‚«ãƒ³ãƒåŒºåˆ‡ã‚Šï¼‰ï¼š</label>
      <input type="text" id="keyInput" placeholder="ä¾‹: space, w"><br>

      <label>ç§’æ•°ï¼š</label>
      <input type="number" id="durationInput" value="3" min="0.1" step="0.1"><br>

      <div class="quick-seconds">
        <strong>ç§’æ•°ã‚’é¸ã¶ï¼š</strong>
        <button onclick="setDuration(1)">1ç§’</button>
        <button onclick="setDuration(2)">2ç§’</button>
        <button onclick="setDuration(3)">3ç§’</button>
      </div>

      <button onclick="sendKeys()">é€ä¿¡</button>
      <button onclick="clearInputs()">ãƒªã‚»ãƒƒãƒˆ</button>
    </div>

    <!-- å³ï¼šã‚ˆãä½¿ã†ã‚­ãƒ¼ -->
    <div class="quick-keys">
      <h3>ğŸ§© ã‚ˆãä½¿ã†ã‚­ãƒ¼</h3>
      <button onclick="addKey('w')">w</button>
      <button onclick="addKey('s')">s</button>
      <button onclick="addKey('a')">a</button>
      <button onclick="addKey('d')">d</button>
      <button onclick="addKey('space')">space</button>
      <button onclick="addKey('right')">right</button>
      <button onclick="addKey('left')">left</button>
      <button onclick="addKey('up')">up</button>
      <button onclick="addKey('down')">down</button>
      <button onclick="addKey('ctrl')">ctrl</button>
      <button onclick="addKey('shift')">shift</button>
    </div>
  </div>

  <!-- âœ… æ“ä½œãƒ­ã‚¸ãƒƒã‚¯ -->
  <script>
    function loadURL() {
      const url = document.getElementById("urlInput").value;
      document.getElementById("webview").src = url;
    }

    function sendKeys() {
      const raw = document.getElementById('keyInput').value;
      const duration = parseFloat(document.getElementById('durationInput').value);
      const keys = raw.split(',')
                      .map(s => s.trim().toLowerCase())
                      .filter(k => k.length > 0);

      if (keys.length && duration > 0) {
        window.keyAPI.pressKeys(keys, duration);
      } else {
        alert("æ­£ã—ã„ã‚­ãƒ¼ã¨ç§’æ•°ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„ã€‚");
      }
    }

    function clearInputs() {
      document.getElementById('keyInput').value = '';
      document.getElementById('durationInput').value = '';
    }

    function setDuration(seconds) {
      document.getElementById('durationInput').value = seconds;
    }

    function addKey(key) {
      const input = document.getElementById('keyInput');
      let current = input.value.split(',').map(k => k.trim().toLowerCase()).filter(k => k);
      if (!current.includes(key)) {
        current.push(key);
        input.value = current.join(', ');
      }
    }

    function openInBrowser() {
      const url = document.getElementById("urlInput").value;
      window.electronAPI.openExternal(url);
    }
  </script>
</body>
</html>
